# 08. 設定変更機能

## タスク概要

ルーム画面内での設定変更機能（入室準備モーダルの再表示）を実装する。

## 実装内容

### 1. 下部バー実装

`src/features/room/ui/room-footer.tsx`
- 現在設定の表示
- 設定変更ボタン
- 退室ボタン

### 2. 現在設定表示

#### ミニプロフィール
- 現在の表示名（省略形）
- 現在のアバターアイコン（小サイズ）
- コンパクトなレイアウト

### 3. 設定変更モーダル

#### モーダル呼び出し
- 「設定を変更」ボタンクリック
- 入室準備モーダルの再表示
- 現在値の初期表示

#### 変更可能項目
- 表示名の変更
- アバタータイプの変更
- プロフィール設定

### 4. リアルタイム反映

#### 即座反映
- 設定変更の即座適用
- Presenceデータの更新
- UI の即座反映

#### 他ユーザーへの通知
- アバター表示の更新
- 表示名の更新
- チャットでの表示名反映

### 5. 設定保存

#### ローカル状態更新
- アプリケーション状態の更新
- ブラウザストレージへの保存
- 設定変更履歴

#### バックエンド同期
- Presenceデータの更新
- 設定変更ログ（将来対応）

### 6. 退室機能

#### 退室確認
```typescript
const handleLeaveRoom = () => {
  const confirmed = confirm('ルームから退室しますか？')
  if (confirmed) {
    leaveRoom()
  }
}
```

#### 退室処理
- Presenceチャンネルからの離脱
- チャットチャンネルからの離脱
- ローカル状態のクリア
- トップページへのリダイレクト

## UI仕様

### 下部バー レイアウト
```
[アバター] [表示名] ............. [設定変更] [退室]
```

### モーダル表示
- 既存の入室準備モーダル再利用
- 「変更を保存」ボタン
- キャンセル機能

### レスポンシブ対応
- モバイルでのボタン配置調整
- タッチ操作への最適化

## 成果物

- `src/features/room/ui/room-footer.tsx`
- 設定変更モーダル機能
- リアルタイム設定反映

## 次のタスク

09_error_handling.md - エラーハンドリングの実装